<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> Rubenclicker test version</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
      #rubenButton {
        height: 50vh;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1;
        cursor: pointer;
      }
      #ouch {
        font-size: 10vh;
        position: fixed;
        top: 20%;
        left: 60%;
        z-index: 4;
      }
      #rubenButtonDiv {
        display: grid;
        place-items: center;
      }
      #rebirthButton {
        position: fixed;
        bottom: 0px;
        left: 0px;
        font-size: 6vh;
        font-family: "Comic Sans MS", Courier New, "Garamond";
        max-width: 50%;
        z-index: 2;
      }
      p {
        font-size: 4vh;
        z-index: 3;
      }
      #hannesButton {
        font-size: 6vh;
        position: fixed;
        top: 0px;
        right: 0px;
        font-family: "Comic Sans MS", Courier New, "Garamond";
        max-width: 50%;
      }
      #upgradeButton {
        font-size: 6vh;
        position: fixed;
        right: 0px;
        bottom: 0px;
        font-family: "Comic Sans MS", Courier New, "Garamond";
        max-width: 50%;
      }
    </style>
  </head>
  <body>
    <p><strong>Welcome to the test version of Rubenclicker!</strong></p>
    
    <p><strong>High score:</strong><br>15025283 clicks <em>by enormous_fortune in level 2197</em></p>
    
    <p><strong>Number of clicks:</strong></p>
    
    <p id="clickDisplay">Preparing click counter...</p>
    
    <p><strong>Your level:</strong></p>
    
    <p id="levelDisplay">Preparing user levels...</p>
    
    <button id="rebirthButton" onclick="rebirth()">Preparing rebirth...</button>
    
    <div id="rubenButtonDiv">  
      <img src="rubenClicker.png" id="rubenButton" alt="Ruben" title="Click to gain one click!" onclick="rubenBeaten()">
    </div>
    
    <p id="ouch" hidden>OUCH!</p>
    
    <button id="hannesButton" onclick="hannesSwitcher()">Preparing Hannes mode...</button>

    <p><strong>Clicks per click: </strong><span id="clickperclickdisplay">preparing clicks...</span></p>

    <button id="upgradeButton" onclick="upgrade()">Preparing upgrade</button>

    <audio autoplay loop><source src="Dance of the Sugar Plum Fairy.mp3" type="audio/mpeg"></audio>
    
    <script>
      let clickCount = 9990;
      let rebirthEnabled = false;
      let leftToRebirth = 2000 - clickCount;
      let rebirthCount = 0;
      let accountLevel = 1;
      let upgradeCount = 0;
      let clicksPerClick = 1 * accountLevel * (2 ** rebirthCount) + (2 * upgradeCount);
      let upgradeAvilaible = false;
      let clicksForRebirth = 2000;
      const ouchAudio = new Audio("RubenClickerOuch.mp3")
      
      function rubenBeaten() {
        clickCount += 1 * clicksPerClick

        document.getElementById("clickDisplay").innerHTML = clickCount
        document.getElementById("upgradeButton").innerHTML = "Upgrade 100:-"
        document.getElementById("ouch").hidden = false
       
        setTimeout(hideOuch, 100)

        leftToRebirth = clicksForRebirth - clickCount
        
        if (clickCount < clicksForRebirth) {
          document.getElementById("rebirthButton").innerHTML = `${leftToRebirth} clicks left to rebirth!`
          rebirthEnabled = false;
          document.getElementById("rebirthButton").style.cursor = "not-allowed"
        } else {
          document.getElementById("rebirthButton").innerHTML = "Click to rebirth!"
          rebirthEnabled = true;
          document.getElementById("rebirthButton").style.cursor = "pointer"
        }
        
        if (clickCount < 10000) {
          document.getElementById("hannesButton").innerHTML = "You need more clicks for Hannes Mode"
        } else {
          document.getElementById("hannesButton").innerHTML = "Click to enable Hannes mode!"
        }

        if (clickCount < 100) {
          upgradeAvilaible = false
        } else {
          upgradeAvilaible = true
        }

        document.getElementById("levelDisplay").innerHTML = rebirthCount + 1
        document.getElementById("clickperclickdisplay").innerHTML = clicksPerClick
        ouchAudio.play();
        
      }
      
      function hideOuch() {
       document.getElementById("ouch").hidden = true   
      }

      function rebirth() {
        if (rebirthEnabled === true) {  
          rebirthCount++
          clickCount = 0
          upgradeCount = 0
          rebirthEnabled = false
          clicksForRebirth = 2000 * (2 ** rebirthCount)
          leftToRebirth = clicksForRebirth - clickCount
          clicksPerClick = 1 * accountLevel * (2 ** rebirthCount) + (2 * upgradeCount)
          document.getElementById("levelDisplay").innerHTML = rebirthCount + 1
          document.getElementById("clickDisplay").innerHTML = clickCount
          document.getElementById("rebirthButton").innerHTML = `${leftToRebirth} clicks left to rebirth!`
          document.getElementById("clickperclickdisplay").innerHTML = clicksPerClick
        }
      }

      function hannesSwitcher() {
        if (clickCount >= 10000) {
          document.getElementById("rubenButton").src = "hannesclicker.png"
          document.getElementById("hannesButton").hidden = "true"
        }
      }

      function upgrade() {
        if (clickCount < 100) {
          document.getElementById("upgradeButton").innerHTML = "More clicks needed"
          setTimeout(1000, displayUpgrade)
        } else {
          clickCount -= 100
          upgradeCount++
          clicksPerClick = 1 * accountLevel * (1 + rebirthCount) + (2 * upgradeCount)
        }
        document.getElementById("clickperclickdisplay").innerHTML = clicksPerClick
        document.getElementById("clickDisplay").innerHTML = clickCount
        leftToRebirth = clicksForRebirth - clickCount
        document.getElementById("rebirthButton").innerHTML = `${leftToRebirth} clicks left to rebirth!`
      }

      function displayUpgrade() {
        document.getElementById("upgradeButton").innerHTML = "Upgrade 100:-"
      }
      
    </script>
  </body>
</html>
